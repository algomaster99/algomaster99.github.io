{% extends "base.html" %}

{% block main_content %}

<script src="{{ get_url(path='js/bibtex_render.js', trailing_slash=false) | safe }}"/></script>
<script src="{{ get_url(path='js/highlight_self.js', trailing_slash=false) | safe }}"/></script>

<div class="container max-w-3xl mx-auto px-4">
    <div class="font-sans py-8">
    </div>

    {% set publications_data = load_data(path="static/publications.json", required=false) %}
    {% if publications_data and publications_data | length > 0 %}
        {% set_global current_year = 0 %}
        {% for paper in publications_data %}
            {% set year = paper.year | default(value=0) %}
            {% if year != current_year %}
                {% if not loop.first %}
                    </ul>
                {% endif %}
                <h1>{{ year }}</h1>
                <ul>
                {% set_global current_year = year %}
            {% endif %}
            
            <li>
                <span>
                    <strong>
                        {% if paper.url %}
                            <a href="{{ paper.url }}" target="_blank">{{ paper.title }}</a>
                        {% else %}
                            {{ paper.title }}
                        {% endif %}
                    </strong>,
                    <span class="authors">{{ paper.authors }}</span>,
                    <i>In</i>
                    {% if paper.journal %}
                        {{ paper.journal }}
                    {% elif paper.venue %}
                        {{ paper.venue }}
                    {% endif %}
                    {% if paper.year %}
                        {{ paper.year }}
                    {% endif %}
                    
                    {% if paper.doi %}
                        <a href="https://doi.org/{{ paper.doi }}" target="_blank" class="clickable">[doi]</a>
                    {% endif %}
                    {% if paper.arxivId %}
                        <a href="https://arxiv.org/abs/{{ paper.arxivId }}" target="_blank" class="clickable">[arxiv]</a>
                    {% endif %}
                    {% if paper.bibtex %}
                        <span id="{{ paper.paperId }}" class="clickable bibtex-toggle">[bibtex]</span>
                        <pre id="bibtex-entry-{{ paper.paperId }}" class="clickable hidden">{{ paper.bibtex }}</pre>
                    {% endif %}
                </span>
            </li>
        {% endfor %}
        </ul>
    {% else %}
        <p>No publications found.</p>
    {% endif %}
</div>

{% endblock main_content %}
